---
title: "summaries"
author: "Fabio Votta"
date: "12 November 2017"
output: html_document
---

```{r chunks, include=FALSE}
#Default Options - kann bei Gebrauch geändert werden
knitr::opts_chunk$set(echo = T # Whether to display code along with its results
                      , eval = T # Whether to evaluate the code and include its results
                      , results = "asis" # this at deafult is in end much more efficient
                      , cache = F # Whether to cache results for future renders (efficient!)
                      , warning = F # Whether to display errors
                      , message = F # Whether to display messages
                      , error = F # maybe turn on
                      , tidy = F # Whether to reformat code in a tidy way when displaying it
                      , fig.width = 6 #plot width at 6
                      , fig.height = 4 #plot height at 4
                      , fig.align = "center" #plot alignment center
                      )

options(xtable.comment = FALSE)
```

```{r setup}
library(sjPlot)
library(sjmisc)
library(car)
library(tidyverse)
library(haven)
library(knitr)
```


```{r cars, echo=FALSE}
path_data <- "C:/Users/Fabio/Dropbox/Bächtiger HA SS17/Daten/"
setwd(path_data)

afro5 <-read_spss("Afro5.sav") #loading dataset
afro6 <-read_spss("Afro6.sav") #loading dataset

delete_na_afro <- function(x) {
  x<-Recode(x, "9 = NA;
               98 = NA;
               99 = NA;
               -1 = NA")
  return(x)
} #Funktion um die NAs im Afro Datensatz zu bestimmen

# alle Variablen
afro_5 <- afro5  %>% 
  rename(educ = Q97,          #Variablen umbenennen
          income = Q3B, 
          sex = Q101, 
          work = Q96,
          trust_gov = Q59A,
          trust_parliament = Q59B,
          trust_police = Q59H,
          trust_courts = Q59J,
          demtoday = Q46A) %>%
  mutate_at(vars(income, trust_gov, trust_parliament, 
                 trust_police, trust_courts, work), 
            delete_na_afro) %>%   #NAs deleten 
          mutate(sex = sex - 1,   #sex (0/1) codieren
                work = Recode(work, #work (0/1) codieren
                 "1 = 0;
                  2 = 1;
                  3 = 1"),
                 age = Recode(Q1, #missing values löschen
                                  "-1 = NA;
                                  998 = NA;
                                  999 = NA"),
            demtoday = Recode(demtoday,
                                  "-1 = NA;
                                   98 = NA;
                                   99 = NA"),
                educ = Recode(educ,
                                  "-1 = NA;
                                   98 = NA;
                                   99 = NA;
                                  999 = NA"),
               cntry = to_label(COUNTRY_ALPHA),
               year = as.numeric(format(DATEINTR,'%Y'))) %>%
  select(cntry,year,age,sex, income, educ, work, demtoday, trust_gov, trust_parliament,
         trust_police, trust_courts) 


####afro6####

# alle Variablen
afro_6 <- afro6 %>%
  rename(educ = Q97, 
         income = Q4B, 
         sex = Q101, 
         work = Q95,
         trust_gov = Q52A,
         trust_parliament = Q52B,
         trust_police = Q52H,
         trust_courts = Q52J,
         demtoday = Q40)%>%
  mutate_at(vars(income, demtoday, trust_gov, 
                 trust_parliament, trust_police, 
                 trust_courts, work), 
            delete_na_afro) %>%   #NAs deleten 
  mutate(sex = sex - 1,   #sex (0/1) codieren
         work = Recode(work, #work (0/1) codieren
                 "1 = 0;
                  2 = 1;
                  3 = 1"),
          age = Recode(Q1, #missing values löschen
                      "-1 = NA;
                      998 = NA;
                      999 = NA"),
         educ = Recode(educ,
                      "-1 = NA;
                       98 = NA;
                       99 = NA;
                      999 = NA"),
    demtoday = Recode(demtoday, 
                       "8 = NA"),
       cntry = to_label(COUNTRY_R5List),
        year = as.numeric(format(DATEINTR,'%Y'))) %>%
  select(cntry,year,age,sex, income, educ, work, demtoday, trust_gov, trust_parliament, trust_police, trust_courts)

latino2013 <-read_spss("C:/Users/Fabio/Dropbox/Bächtiger HA SS17/Daten/latino2013.sav") #loading dataset
latino2015 <-read_spss("latino2015.sav") #loading dataset

latino_2013 <-latino2013 %>% 
  rename(educ = REEDUC_1,
         income = S6,
         demtoday = P50TGB.A,
         age = S11) %>%
  mutate(sex = S10 - 1, #sex variable erstellen
         cntry = to_label(IDENPA), #cntry variable erstellen
         trust_gov = 5-P26TGB.B,
         trust_parliament = 5-P26TGB.C,
         trust_police = 5-P28TGB.B,
         trust_courts = 5-P26TGB.E,
         year = 2013,
         income = 5 - income,
         work = Recode(S19.A,
                           "2 = 1;
                            3 = 1;
                            4 = 0;
                            5 = 0;
                            6 = 0;
                            7 = 0")) %>%
  select(cntry,year,age,sex, income, educ, work, demtoday, trust_gov, trust_parliament,
         trust_police, trust_courts)


latino_2015 <-latino2015 %>% 
  mutate(sex = S12 - 1) %>% #sex variable erstellen
  rename(educ = REEDUC_1,
         income = S4,
         demtoday = P17STGBS,
         age = S13) %>%
  mutate(trust_gov = 5-P16ST.G,
         trust_parliament = 5-P16ST.F,
         trust_police = 5-P16TGB.B,
         trust_courts = 5-P16ST.H,
         work = Recode(S21.A,
                           "2 = 1;
                            3 = 1;
                            4 = 0;
                            5 = 0;
                            6 = 0;
                            7 = 0"),
         cntry = to_label(IDENPA),
         income = 5 - income,
         year = 2015) %>%
  select(cntry,year,age,sex, income, educ, work, demtoday, trust_gov, trust_parliament,
         trust_police, trust_courts)
         
#wvs

wvs_raw <-read_spss("wv6.sav") #loading dataset

wvs <-wvs_raw %>% 
  rename(educ = V248,
         income = V239,
         demtoday = V141,
         age = V242,
         year = V262) %>%
  mutate(sex = V240 -1,  #sex variable erstellen
         trust_gov = 5-V115,
         trust_parliament = 5-V117,
         trust_police = 5-V113,
         trust_courts = 5-V114,
         work = Recode(V229,
                       "2 = 1;
                       3 = 1;
                       4 = 0;
                       5 = 0;
                       6 = 0;
                       7 = 0;
                       8 = 0"),
         cntry = to_label(V2)) %>%
  select(cntry,year,age,sex, income, educ, work, demtoday, 
         trust_gov, trust_parliament,
         trust_police, trust_courts)

# americas

americas <-read_spss("C:/data/americas.sav")
bolivia <- read_spss("americasbarometer/bolivia2012.sav")
canada <- read_spss("americasbarometer/canada2010.sav")

americas_ <- americas %>%
  mutate(cntry = to_label(pais)) %>%
  select(cntry, ocup4a, ed, q10new, q1, q2, 
         b10a, b13, b18, b21a, n3) %>%
  rename(work = ocup4a,
         educ = ed,
         income = q10new,
         sex = q1,
         age = q2,
         trust_courts = b10a,
         trust_parliament = b13,
         trust_police = b18,
         trust_gov = b21a,
         demtoday = n3) %>%
  mutate(sex = sex -1,  #sex variable erstellen
         work = Recode(work,
                      "2 = 1;
                       3 = 1;
                       4 = 0;
                       5 = 0;
                       6 = 0;
                       7 = 0"))

canada_ <- canada %>%
  mutate(cntry = to_label(pais)) %>%
  select(cntry, exc13, education, q10, q1, q2, 
         b10a, b13, b18, b21a, n3, year) %>%
  rename(work = exc13,
         educ = education,
         income = q10,
         sex = q1,
         age = q2,
         trust_courts = b10a,
         trust_parliament = b13,
         trust_police = b18,
         trust_gov = b21a,
         demtoday = n3) %>%
  mutate(sex = sex -1,  #sex variable erstellen
         work = work - 1,
         income = ifelse(income == 88, NA, income))      

asian_raw <-read_spss("wave3datapart2/ABS3w.0.Merged/ABS3 merge20170818.sav") #loading dataset


delete_na_asian <- function(x) {
  x<-Recode(x,
              "-2 = NA;
                7 = NA;
                8 = NA;
                9 = NA;
               97 = NA;
               98 = NA;
               99 = NA;
               -1 = NA")

  return(x)
} #Funktion um die NAs im asian Datensatz zu bestimmen

asian_3 <- asian_raw %>%
  rename(educ = se5,
         trust_gov = q9,
  trust_parliament = q11,
      trust_police = q14,
      trust_courts = q8,
               sex = se2,
            income = se13a,
              work = se9) %>%
  mutate_at(vars(income, trust_gov, trust_parliament, 
              trust_police, trust_courts, work, sex), 
         delete_na_asian) %>%   #NAs deleten 
  mutate(trust_gov = 5 - trust_gov,
  trust_parliament = 5 - trust_parliament,
      trust_police = 5 - trust_police,
      trust_courts = 5 - trust_courts,
               sex = sex - 1,   #sex (0/1) codieren
            income = Recode(income,
                           "0 = NA"),
            income = 5 - income,
              work = Recode(work, #work (0/1) codieren
                           "2 = 0"),
               age = Recode(se3a, #missing values löschen
                          "-1 = NA"),
          demtoday = Recode(q91,
                          "-1 = NA;
                           97 = NA;
                           98 = NA;
                           99 = NA"),
              educ = Recode(educ,
                          "-1 = NA;
                           98 = NA;
                           99 = NA"),
             cntry = to_label(country),
              year = as.numeric(format(ir9,'%Y'))) %>%
  select(cntry,year,age,sex, income, educ, work, demtoday, trust_gov, trust_parliament,
         trust_police, trust_courts)      

myanmar_raw <-read_spss("wave4data/ABS4_06. Myanmar/W4_Myanmar_20170711_release.sav") #loading dataset
mongolia_raw <-read_spss("wave4data/ABS4_01. Mongolia/W4_Mongolia_20161230_release.sav") #loading dataset
philip_raw <-read_spss("wave4data/ABS4_02. Philippines/W4_Philippines_20161230_release.sav") #loading dataset
taiwan_raw <-read_spss("wave4data/ABS4_03. Taiwan/W4_Taiwan_20170308_release.sav") #loading dataset
thai_raw <-read_spss("wave4data/ABS4_04. Thailand/W4_Thailand_20161230_release.sav") #loading dataset
malay_raw <-read_spss("wave4data/ABS4_05. Malaysia/W4_Malaysia_20170424_release.sav") #loading dataset
singapore_raw <-read_spss("wave4data/ABS4_07. Singapore/W4_Singapore_20170712_release.sav") #loading dataset
sk_raw <-read_spss("wave4data/ABS4_08. South Korea/W4_Korea_20170302_release.sav") #loading dataset
cambodia_raw <-read_spss("wave4data/ABS4_09. Cambodia/W4_Cambodia_20170626_release.sav") #loading dataset

needed <- function (data) {
  ss <- data %>%
    rename(educ = se5,
         trust_gov = q9,
  trust_parliament = q11,
      trust_police = q14,
      trust_courts = q8,
               sex = se2,
            income = se13a,
              work = se9) %>%
  mutate_at(vars(income, trust_gov, trust_parliament, 
              trust_police, trust_courts, work, sex), 
         delete_na_asian) %>%   #NAs deleten 
  mutate(trust_gov = 5 - trust_gov,
  trust_parliament = 5 - trust_parliament,
      trust_police = 5 - trust_police,
      trust_courts = 5 - trust_courts,
               sex = sex - 1,   #sex (0/1) codieren
            income = Recode(income,
                           "0 = NA"),
              work = Recode(work, #work (0/1) codieren
                           "2 = 0"),
               age = Recode(se3_2, #missing values löschen
                          "-1 = NA"),
          demtoday = Recode(q94,
                          "-1 = NA;
                           97 = NA;
                           98 = NA;
                           99 = NA"),
              educ = Recode(educ,
                          "-1 = NA;
                           98 = NA;
                           99 = NA"),
             cntry = to_label(country),
              year = year) %>%
  select(cntry,year,age,sex, income, educ, work, demtoday, trust_gov, trust_parliament,
         trust_police, trust_courts)    
  return(ss)
}

myanmar <- needed(myanmar_raw)
mongolia <- needed(mongolia_raw)
philip <- needed(philip_raw)
taiwan <- needed(taiwan_raw)
thai <- needed(thai_raw)
malay <- needed(malay_raw)
singapore <- needed(singapore_raw) #Singapore hat extrem viele Missing values
sk <- needed(sk_raw)
cambodia <- needed(cambodia_raw)


ESS_raw <- read_spss("ESS6e02_3.spss/ESS6e02_3.sav")

ESS <-ESS_raw %>% 
  rename(demtoday = dmcntov,
         age = agea,
         year = inwyys,
         trust_gov = trstplt,
         trust_parliament = trstprl,
         trust_police = trstplc,
         trust_courts = trstlgl) %>%
  mutate(income = 5 - hincfel,
         educ = Recode(eisced,
                          "55 = NA"),
         work = ifelse(mnactic == 1, 1, 0),
         sex = gndr - 1, #sex variable erstellen
         cntry = to_label(cntry)) %>%
  select(cntry,year,age,sex, income, educ, work, demtoday, trust_gov, trust_parliament,
         trust_police, trust_courts)
```

## Description

```{r pressure, results="markup"}


afro_5 %>%
  descr() %>%
  remove_var(type, se, md, trimmed, skew, kurtosis) %>%
  kable()
afro_6 %>%
  descr() %>%
  remove_var(type, se, md, trimmed, skew, kurtosis) %>%
  kable()
latino_2013 %>%
  descr() %>%
  remove_var(type, se, md, trimmed, skew, kurtosis) %>%
  kable()
latino_2015 %>%
  descr() %>%
  remove_var(type, se, md, trimmed, skew, kurtosis) %>%
  kable()
wvs %>%
  descr() %>%
  remove_var(type, se, md, trimmed, skew, kurtosis) %>%
  kable()
americas_ %>%
  descr() %>%
  remove_var(type, se, md, trimmed, skew, kurtosis) %>%
  kable()
canada_ %>%
  descr() %>%
  remove_var(type, se, md, trimmed, skew, kurtosis) %>%
  kable()
asian_3 %>%
  descr() %>%
  remove_var(type, se, md, trimmed, skew, kurtosis) %>%
  kable()
myanmar %>%
  descr() %>%
  remove_var(type, se, md, trimmed, skew, kurtosis) %>%
  kable()
mongolia %>%
  descr() %>%
  remove_var(type, se, md, trimmed, skew, kurtosis) %>%
  kable()
philip %>%
  descr() %>%
  remove_var(type, se, md, trimmed, skew, kurtosis) %>%
  kable()
taiwan %>%
  descr() %>%
  remove_var(type, se, md, trimmed, skew, kurtosis) %>%
  kable()
thai %>%
  descr() %>%
  remove_var(type, se, md, trimmed, skew, kurtosis) %>%
  kable()
malay %>%
  descr() %>%
  remove_var(type, se, md, trimmed, skew, kurtosis) %>%
  kable()
singapore %>%
  descr() %>%
  remove_var(type, se, md, trimmed, skew, kurtosis) %>%
  kable()
sk %>%
  descr() %>%
  remove_var(type, se, md, trimmed, skew, kurtosis) %>%
  kable()
cambodia %>%
  descr() %>%
  remove_var(type, se, md, trimmed, skew, kurtosis) %>%
  kable()

```


